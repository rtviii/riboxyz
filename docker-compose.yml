version: '3.8'
services:
  django:
    container_name: django
    restart: always
    build:
      context: .
      dockerfile: Dockerfile-django
    ports:
      - 8000:8000
    volumes:
      - type: bind
        source: ${RIBETL_DATA:?err}
        target: /home/backend/api/ribetldata
      # FOR LIVE DEVELOPMENT -----------------------|
      - ./api:/home/backend/api                    #|  <--- DEV ONLY
      # --------------------------------------------|
    environment:
      - NEO4J_URI=bolt://neo:7687
      - NEO4J_USER=neo4j
      - NEO4J_PASSWORD=55288
      - NEO4J_CURRENTDB=neo4j

    links:
      - neo
    depends_on:
      - neo
  neo:
    hostname: neo
    container_name: neo
    restart: always
    build:
      context: .
      dockerfile: Dockerfile-neo4j
    ports:
      - 7473:7473
      - 7474:7474
      - 7687:7687

    volumes:
      - /opt/ribxz_neo4j_volume/plugins:/plugins
      - /opt/ribxz_neo4j_volume/data:/data

      - type  : bind
        source: ${RIBETL_DATA:?err}
        target: /import

volumes:
  django:
  neo: